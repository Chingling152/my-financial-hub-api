name: "API Release"

on:
  workflow_dispatch:
  pull_request:
    types:
      - synchronize
      - closed
    branches: 
      - 'release/**'
    #paths:
    #  - 'src/FinancialHub/*' 
    #  - 'src/FinancialHub/**'

jobs:
  releases:
    name: Release
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 0

    - name: Test 4
      run: echo "${{ github.event.pull_request.base.ref }} ${{ github.event.pull_request.head.ref }}"
      shell: bash

    - name: Get version
      env:
        BRANCH: ${{ github.event.pull_request.base.ref }}
      id: version
      run: echo "value=${BRANCH##*/}"	>> $GITHUB_OUTPUT

    - name: Create Release
      id: create_release
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tag_name: ${{ steps.version.outputs.value }}
        release_name: Release ${{ steps.version.outputs.value }}
        body: 
        draft: true
        prerelease: true

    #- name: Upload Release Asset
    #  id: upload-release-asset 
    #  uses: actions/upload-release-asset@v1
    #  env:
    #    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    #  with:
    #    upload_url: ${{ steps.create_release.outputs.upload_url }} 
    #    asset_path: ./my-artifact.zip
    #    asset_name: my-artifact.zip
    #    asset_content_type: application/zip